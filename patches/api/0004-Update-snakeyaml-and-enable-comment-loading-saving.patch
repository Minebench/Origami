From 2499baf425c06664e972d5dd05d70d5c8e59b5f4 Mon Sep 17 00:00:00 2001
From: Phoenix616 <max@themoep.de>
Date: Wed, 9 Jun 2021 12:51:29 +0100
Subject: [PATCH] Update snakeyaml and enable comment loading/saving

---
 pom.xml                                                         | 2 +-
 .../java/org/bukkit/configuration/file/YamlConfiguration.java   | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/pom.xml b/pom.xml
index 19fb839b..4bf9c679 100644
--- a/pom.xml
+++ b/pom.xml
@@ -114,7 +114,7 @@
         <dependency>
             <groupId>org.yaml</groupId>
             <artifactId>snakeyaml</artifactId>
-            <version>1.27</version>
+            <version>1.29</version> <!-- Origami - update snakeyml -->
             <scope>compile</scope>
         </dependency>
         <!-- annotations -->
diff --git a/src/main/java/org/bukkit/configuration/file/YamlConfiguration.java b/src/main/java/org/bukkit/configuration/file/YamlConfiguration.java
index 6476f379..e9e3591f 100644
--- a/src/main/java/org/bukkit/configuration/file/YamlConfiguration.java
+++ b/src/main/java/org/bukkit/configuration/file/YamlConfiguration.java
@@ -35,6 +35,7 @@ public class YamlConfiguration extends FileConfiguration {
     public String saveToString() {
         yamlOptions.setIndent(options().indent());
         yamlOptions.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);
+        yamlOptions.setProcessComments(!Boolean.getBoolean("de.minebench.origami.disableyamlcomments")); // Origami - Process yaml comments
         yamlRepresenter.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);
 
         String header = buildHeader();
@@ -53,6 +54,7 @@ public class YamlConfiguration extends FileConfiguration {
 
         Map<?, ?> input;
         try {
+            loaderOptions.setProcessComments(!Boolean.getBoolean("de.minebench.origami.disableyamlcomments")); // Origami - Process yaml comments
             loaderOptions.setMaxAliasesForCollections(Integer.MAX_VALUE); // SPIGOT-5881: Not ideal, but was default pre SnakeYAML 1.26
             input = (Map<?, ?>) yaml.load(contents);
         } catch (YAMLException e) {
-- 
2.25.1.windows.1

