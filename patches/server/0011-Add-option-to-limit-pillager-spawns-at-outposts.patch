From 595ad3eb03283299bbece2a2b84d74e6fd93a732 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Mon, 2 Dec 2019 17:55:50 +0100
Subject: [PATCH] Add option to limit pillager spawns at outposts

---
 src/main/java/com/destroystokyo/paper/PaperWorldConfig.java  | 5 +++++
 .../java/net/minecraft/server/ChunkProviderGenerate.java     | 1 +
 2 files changed, 6 insertions(+)

diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
index 68d36a51..b62ef547 100644
--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
@@ -636,6 +636,11 @@ public class PaperWorldConfig {
         generateFlatBedrock = getBoolean("generator-settings.flat-bedrock", false);
     }
 
+    public int limitPillagerOutpostSpawns = 10;
+    private void limitPillagerOutpostSpawns() {
+        limitPillagerOutpostSpawns = getInt("limit-pillager-outpost-spawns", limitPillagerOutpostSpawns);
+    }
+
     public boolean disablePillagerPatrols = false;
     private void pillagerSettings() {
         disablePillagerPatrols = getBoolean("game-mechanics.disable-pillager-patrols", disablePillagerPatrols);
diff --git a/src/main/java/net/minecraft/server/ChunkProviderGenerate.java b/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
index b794a39d..95249e10 100644
--- a/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
+++ b/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
@@ -142,6 +142,7 @@ public class ChunkProviderGenerate extends ChunkGeneratorAbstract<GeneratorSetti
             }
         } else if (enumcreaturetype == EnumCreatureType.MONSTER) {
             if (WorldGenerator.PILLAGER_OUTPOST.a(this.a, blockposition)) {
+                if (getWorld().paperConfig.limitPillagerOutpostSpawns > 0 && getWorld().a(EntityPillager.class, new AxisAlignedBB(blockposition).grow(128)).size() < getWorld().paperConfig.limitPillagerOutpostSpawns) // Paper
                 return WorldGenerator.PILLAGER_OUTPOST.e();
             }
 
-- 
2.18.0.windows.1

