From 23f3576ae59f8c1cba909d1129a78d0a8b252e52 Mon Sep 17 00:00:00 2001
From: Phoenix616 <mail@moep.tv>
Date: Sat, 4 Jul 2020 20:08:42 +0100
Subject: [PATCH] Keep whether clear after sleep

---
 src/main/java/net/minecraft/server/WorldData.java   | 1 +
 src/main/java/net/minecraft/server/WorldServer.java | 1 +
 2 files changed, 2 insertions(+)

diff --git a/src/main/java/net/minecraft/server/WorldData.java b/src/main/java/net/minecraft/server/WorldData.java
index 95518e54d1..386d5be27a 100644
--- a/src/main/java/net/minecraft/server/WorldData.java
+++ b/src/main/java/net/minecraft/server/WorldData.java
@@ -526,6 +526,7 @@ public class WorldData {
         return this.clearWeatherTime;
     }
 
+    public void setClearWeatherTime(int ticks) { this.g(ticks); } // Origami - OFBHELPER
     public void g(int i) {
         this.clearWeatherTime = i;
     }
diff --git a/src/main/java/net/minecraft/server/WorldServer.java b/src/main/java/net/minecraft/server/WorldServer.java
index 46e261b651..643d70507d 100644
--- a/src/main/java/net/minecraft/server/WorldServer.java
+++ b/src/main/java/net/minecraft/server/WorldServer.java
@@ -740,6 +740,7 @@ public class WorldServer extends World {
     }
 
     private void clearWeather() {
+        this.worldData.setClearWeatherTime(this.randomTickRandom.nextInt(6000)); // Origami - keep weather clear for at least 5 minutes after sleep
         // CraftBukkit start
         this.worldData.setStorm(false);
         // If we stop due to everyone sleeping we should reset the weather duration to some other random value.
-- 
2.25.1.windows.1

