From 15784b1e870a5a5ce2e9d792535dfb47c8cf7907 Mon Sep 17 00:00:00 2001
From: Phoenix616 <mail@moep.tv>
Date: Sat, 6 Jun 2020 00:11:31 +0100
Subject: [PATCH] Maps only update loaded chunks

---
 src/main/java/net/minecraft/server/ItemWorldMap.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/main/java/net/minecraft/server/ItemWorldMap.java b/src/main/java/net/minecraft/server/ItemWorldMap.java
index 189e6d753d..b6cc152bd6 100644
--- a/src/main/java/net/minecraft/server/ItemWorldMap.java
+++ b/src/main/java/net/minecraft/server/ItemWorldMap.java
@@ -96,9 +96,9 @@ public class ItemWorldMap extends ItemWorldMapBase {
                             int k2 = (j / i + k1 - 64) * i;
                             int l2 = (k / i + l1 - 64) * i;
                             Multiset<MaterialMapColor> multiset = LinkedHashMultiset.create();
-                            Chunk chunk = world.getChunkAtWorldCoords(new BlockPosition(k2, 0, l2));
+                            Chunk chunk = world.getChunkIfLoaded(new BlockPosition(k2, 0, l2)); // Origami - Maps only update loaded chunks
 
-                            if (!chunk.isEmpty()) {
+                            if (chunk != null && !chunk.isEmpty()) { // Origami - Maps only update loaded chunks
                                 ChunkCoordIntPair chunkcoordintpair = chunk.getPos();
                                 int i3 = k2 & 15;
                                 int j3 = l2 & 15;
-- 
2.25.1.windows.1

