From 027d1e5d39e79645dd3bb96f119155bf53289e62 Mon Sep 17 00:00:00 2001
From: Phoenix616 <mail@moep.tv>
Date: Mon, 15 Jul 2019 03:10:03 +0100
Subject: [PATCH] Option to register all commands into the vanilla command map

---
 src/main/java/org/bukkit/craftbukkit/CraftServer.java | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index a8ac59d54..b31fdf7fe 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -394,7 +394,12 @@ public final class CraftServer implements Server {
 
     private void syncCommands() {
         // Clear existing commands
-        CommandDispatcher dispatcher = console.commandDispatcher = new CommandDispatcher();
+        // Origami start - Register commands directly in Vanilla dispatcher
+        if (!OrigamiConfig.pluginCommandsInVanillaDispatcher) {
+            console.commandDispatcher= new CommandDispatcher();
+        }
+        CommandDispatcher dispatcher = console.commandDispatcher;
+        // Origami end
 
         // Register all commands, vanilla ones will be using the old dispatcher references
         for (Map.Entry<String, Command> entry : commandMap.getKnownCommands().entrySet()) {
-- 
2.18.0.windows.1

